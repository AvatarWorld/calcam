

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Examples &mdash; Calcam  documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="Calcam  documentation" href="index.html"/>
        <link rel="next" title="Image Sources" href="dev_imsources.html"/>
        <link rel="prev" title="CAD Models" href="api_cadmodel.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html">
          

          
            
            <img src="_static/logo.png" class="logo" />
          
          </a>

          
            
            
              <div class="version">
                Version 2.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Introduction</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="intro_general.html">Genral Introduction to Calcam</a></li>
<li class="toctree-l1"><a class="reference internal" href="intro_theory.html">Camera Calibration Theory</a><ul>
<li class="toctree-l2"><a class="reference internal" href="intro_theory.html#camera-model">Camera Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro_theory.html#perspective-distortion-model">Perspective Distortion Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro_theory.html#fisheye-distirtion-model">Fisheye Distirtion Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro_theory.html#underlying-opencv-documentation">Underlying OpenCV Documentation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="intro_install_setup.html">Installation &amp; Setup</a><ul>
<li class="toctree-l2"><a class="reference internal" href="intro_install_setup.html#dependencies">Dependencies</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro_install_setup.html#download-installation">Download &amp; Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro_install_setup.html#cad-models-and-image-sources">CAD Models and Image Sources</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro_install_setup.html#upgrading-from-calcam-1-x">Upgrading from Calcam 1.x</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="intro_conventions.html">Concepts &amp; Conventions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="intro_conventions.html#image-pixel-coordinates">Image Pixel Coordinates</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro_conventions.html#sub-views">Sub-views</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro_conventions.html#cad-models">CAD Models</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">GUI App User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="gui_intro.html">Calcam GUI tools and launcher</a><ul>
<li class="toctree-l2"><a class="reference internal" href="gui_intro.html#starting-the-launcher">Starting the launcher</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="gui_calib.html">Calibration by point fitting</a><ul>
<li class="toctree-l2"><a class="reference internal" href="gui_calib.html#loading-an-image-to-calibrate">Loading an Image to Calibrate</a></li>
<li class="toctree-l2"><a class="reference internal" href="gui_calib.html#image-mouse-navigation">Image Mouse Navigation</a></li>
<li class="toctree-l2"><a class="reference internal" href="gui_calib.html#current-image-settings">Current Image Settings</a></li>
<li class="toctree-l2"><a class="reference internal" href="gui_calib.html#loading-and-manipulating-a-cad-model">Loading and manipulating a CAD model</a></li>
<li class="toctree-l2"><a class="reference internal" href="gui_calib.html#defining-calibration-points">Defining Calibration Points</a></li>
<li class="toctree-l2"><a class="reference internal" href="gui_calib.html#fitting-the-camera-model">Fitting the camera model</a></li>
<li class="toctree-l2"><a class="reference internal" href="gui_calib.html#saving-loading-and-viewing-calibration-information">Saving / Loading and viewing calibration information</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="gui_alignment_calib.html">Calibration by manual alignment</a><ul>
<li class="toctree-l2"><a class="reference internal" href="gui_alignment_calib.html#loading-an-image-to-calibrate">Loading an Image to Calibrate</a></li>
<li class="toctree-l2"><a class="reference internal" href="gui_alignment_calib.html#current-image-settings">Current Image Settings</a></li>
<li class="toctree-l2"><a class="reference internal" href="gui_alignment_calib.html#loading-a-cad-model">Loading a CAD model</a></li>
<li class="toctree-l2"><a class="reference internal" href="gui_alignment_calib.html#performing-the-alignment-calibration">Performing the alignment calibration</a></li>
<li class="toctree-l2"><a class="reference internal" href="gui_alignment_calib.html#saving-loading-and-viewing-calibration-information">Saving / Loading and viewing calibration information</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="gui_virtual_calib.html">&#8220;Virtual&#8221; Calibrations</a><ul>
<li class="toctree-l2"><a class="reference internal" href="gui_virtual_calib.html#loading-a-cad-model">Loading a CAD model</a></li>
<li class="toctree-l2"><a class="reference internal" href="gui_virtual_calib.html#creating-the-virtual-calibration">Creating the Virtual Calibration</a></li>
<li class="toctree-l2"><a class="reference internal" href="gui_virtual_calib.html#saving-loading-and-viewing-calibration-information">Saving / Loading and viewing calibration information</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="gui_image_analyser.html">Image Analyser</a><ul>
<li class="toctree-l2"><a class="reference internal" href="gui_image_analyser.html#loading-an-image-to-analyse">Loading an image to analyse</a></li>
<li class="toctree-l2"><a class="reference internal" href="gui_image_analyser.html#loading-a-calibration">Loading a Calibration</a></li>
<li class="toctree-l2"><a class="reference internal" href="gui_image_analyser.html#loading-a-cad-model">Loading a CAD model</a></li>
<li class="toctree-l2"><a class="reference internal" href="gui_image_analyser.html#performing-position-analysis">Performing Position Analysis</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="gui_viewer.html">3D Viewer</a><ul>
<li class="toctree-l2"><a class="reference internal" href="gui_viewer.html#loading-a-cad-model">Loading a CAD model</a></li>
<li class="toctree-l2"><a class="reference internal" href="gui_viewer.html#turning-cad-model-parts-on-off">Turning CAD model parts On/Off</a></li>
<li class="toctree-l2"><a class="reference internal" href="gui_viewer.html#cad-model-appearance-settings">CAD model appearance settings</a></li>
<li class="toctree-l2"><a class="reference internal" href="gui_viewer.html#wall-contour-display">Wall contour display</a></li>
<li class="toctree-l2"><a class="reference internal" href="gui_viewer.html#mouse-navigation">Mouse Navigation</a></li>
<li class="toctree-l2"><a class="reference internal" href="gui_viewer.html#d-viewport-tab">3D ViewPort Tab</a></li>
<li class="toctree-l2"><a class="reference internal" href="gui_viewer.html#visualising-camera-fields-of-view">Visualising camera fields of view</a></li>
<li class="toctree-l2"><a class="reference internal" href="gui_viewer.html#displaying-arbitrary-3d-lines">Displaying Arbitrary 3D Lines</a></li>
<li class="toctree-l2"><a class="reference internal" href="gui_viewer.html#rendering-and-saving-images">Rendering and saving images</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="gui_settings.html">Calcam Settings</a><ul>
<li class="toctree-l2"><a class="reference internal" href="gui_settings.html#cad-model-definition-settings">CAD Model Definition Settings</a></li>
<li class="toctree-l2"><a class="reference internal" href="gui_settings.html#image-source-settings">Image Source Settings</a></li>
<li class="toctree-l2"><a class="reference internal" href="gui_settings.html#environment-information">Environment Information</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">API User Guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="api_analysis.html">Using Calibration Results</a><ul>
<li class="toctree-l2"><a class="reference internal" href="api_analysis.html#the-calibration-class">The Calibration Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="api_analysis.html#rendering-images">Rendering images</a></li>
<li class="toctree-l2"><a class="reference internal" href="api_analysis.html#ray-casting">Ray casting</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api_cadmodel.html">CAD Models</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#mapping-a-magnetic-field-line-on-to-an-image">Mapping a magnetic field line on to an image</a></li>
<li class="toctree-l2"><a class="reference internal" href="#rendering-camera-view-wireframe">Rendering: camera view wireframe</a></li>
<li class="toctree-l2"><a class="reference internal" href="#ray-casting">Ray casting</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Developer Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="dev_imsources.html">Image Sources</a><ul>
<li class="toctree-l2"><a class="reference internal" href="dev_imsources.html#return-format-of-image-loading-function">Return format of image loading function</a></li>
<li class="toctree-l2"><a class="reference internal" href="dev_imsources.html#structure-of-get-image-arguments">Structure of get_image_arguments</a></li>
<li class="toctree-l2"><a class="reference internal" href="dev_imsources.html#example">Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="dev_imsources.html#adding-to-calcam">Adding to Calcam</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="dev_coord_formatter.html">3D Coordinate Formatters</a><ul>
<li class="toctree-l2"><a class="reference internal" href="dev_coord_formatter.html#example">Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="dev_coord_formatter.html#note-on-sub-module-and-function-names">Note on sub-module and function names</a></li>
<li class="toctree-l2"><a class="reference internal" href="dev_coord_formatter.html#adding-to-a-cad-model">Adding to a CAD model</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Calcam</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Examples</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="examples">
<h1>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h1>
<div class="section" id="mapping-a-magnetic-field-line-on-to-an-image">
<h2>Mapping a magnetic field line on to an image<a class="headerlink" href="#mapping-a-magnetic-field-line-on-to-an-image" title="Permalink to this headline">¶</a></h2>
<p>We start from an image of a MAST plasma on to which we want to overlay a magnetic field line:</p>
<p>which we will assume is saved as <code class="docutils literal"><span class="pre">image.png</span></code> in the current directory.
We also have a Calcam calibration for that image stored in the file <code class="docutils literal"><span class="pre">mycalib.ccc</span></code>, which for convenience we assume is also saved in the current directory. Finally, we have a <code class="docutils literal"><span class="pre">.csv</span></code> file containing a set of 3D coordinates along the magnetic field line we want to show on the image (generated using a field line tracing tool), as a 3 columns containg X,Y,Z coordinates along the field line and one 3D point per line.</p>
<p>We can plot the field line on top of the image with the following code:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">calcam</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">cv2</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>

<span class="c1"># Load the image using OpenCV</span>
<span class="n">cam_image</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="s1">&#39;image.png&#39;</span><span class="p">)</span>

<span class="c1"># Load the field line coordinates</span>
<span class="n">fieldline_3d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s1">&#39;fieldline.csv&#39;</span><span class="p">,</span><span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>

<span class="c1"># Load the calcam calibration</span>
<span class="n">cam_calib</span> <span class="o">=</span> <span class="n">calcam</span><span class="o">.</span><span class="n">Calibration</span><span class="p">(</span><span class="s1">&#39;mycalib.ccc&#39;</span><span class="p">)</span>

<span class="c1"># Project the field line coordinates to image coordinates using calcam.</span>
<span class="c1"># Note: the [0] index here is because this is a single sub-view image and</span>
<span class="c1"># we want the image coordinates for sub-view #0.</span>
<span class="n">fieldline_2d</span> <span class="o">=</span> <span class="n">cam_calib</span><span class="o">.</span><span class="n">project_points</span><span class="p">(</span><span class="n">fieldline_3d</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># Plot the projected coordinates on the image.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">cam_image</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fieldline_2d</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">fieldline_2d</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>This results in the figure below:</p>
<img alt="MAST field line projection example" src="_images/mast_fieldline_example_1.png" />
<p>Note that the parts of the field line hidden behind the centre stack are still visible, which looks strange. To only show the parts of the field line which are not hidden behind parts of the machine, we can modify the above code to also load the MAST CAD model and check</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">calcam</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">cv2</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>

<span class="c1"># Load the image using OpenCV</span>
<span class="n">cam_image</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="s1">&#39;image.png&#39;</span><span class="p">)</span>

<span class="c1"># Load the field line coordinates</span>
<span class="n">fieldline_3d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s1">&#39;fieldline.csv&#39;</span><span class="p">,</span><span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>

<span class="c1"># Load the calcam calibration</span>
<span class="n">cam_calib</span> <span class="o">=</span> <span class="n">calcam</span><span class="o">.</span><span class="n">Calibration</span><span class="p">(</span><span class="s1">&#39;mycalib.ccc&#39;</span><span class="p">)</span>

<span class="c1"># Load the MAST CAD model</span>
<span class="n">mast_machine</span> <span class="o">=</span> <span class="n">calcam</span><span class="o">.</span><span class="n">CADModel</span><span class="p">(</span><span class="s1">&#39;MAST&#39;</span><span class="p">)</span>

<span class="c1"># Project the field line coordinates to image coordinates using calcam.</span>
<span class="c1"># This time, check for occlusion of the points by the CAD model.</span>
<span class="c1"># Note: the [0] index here is because this is a single sub-view image and</span>
<span class="c1"># we want the image coordinates for sub-view #0.</span>
<span class="n">fieldline_2d</span> <span class="o">=</span> <span class="n">cam_calib</span><span class="o">.</span><span class="n">project_points</span><span class="p">(</span><span class="n">fieldline_3d</span><span class="p">,</span><span class="n">check_occlusion_with</span><span class="o">=</span><span class="n">mast_machine</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># Plot the projected coordinates on the image.</span>
<span class="c1"># Occluded points now have np.nan in their coordinates, so MatPlotLib skips them</span>
<span class="c1"># and we see only the points not hidden behind bits of CAD model.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">cam_image</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fieldline_2d</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">fieldline_2d</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>Which results in the following figure:</p>
<img alt="MAST field line projection example" src="_images/mast_fieldline_example_2.png" />
</div>
<div class="section" id="rendering-camera-view-wireframe">
<h2>Rendering: camera view wireframe<a class="headerlink" href="#rendering-camera-view-wireframe" title="Permalink to this headline">¶</a></h2>
<p>For this example, we start with a Calcam calibration for a MAST camera, and we want to render a wireframe version of the MAST CAD model which aligns with the camera image, for example to use as an overlay on a camera image to give better context to the image. We can do this with the following code:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">calcam</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>

<span class="c1"># Load the calcam calibration</span>
<span class="n">cam_calib</span> <span class="o">=</span> <span class="n">calcam</span><span class="o">.</span><span class="n">Calibration</span><span class="p">(</span><span class="s1">&#39;mycalib.ccc&#39;</span><span class="p">)</span>

<span class="c1"># Load the MAST CAD model and set it to be bright red wireframe</span>
<span class="n">mast_machine</span> <span class="o">=</span> <span class="n">calcam</span><span class="o">.</span><span class="n">CADModel</span><span class="p">(</span><span class="s1">&#39;MAST&#39;</span><span class="p">)</span>
<span class="n">mast_machine</span><span class="o">.</span><span class="n">set_wireframe</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
<span class="n">mast_machine</span><span class="o">.</span><span class="n">set_colour</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>

<span class="c1"># Render the image to produce the array rendered_im</span>
<span class="c1"># Also save as an image file &quot;wireframe.png&quot;</span>
<span class="n">rendered_im</span> <span class="o">=</span> <span class="n">calcam</span><span class="o">.</span><span class="n">render_cam_view</span><span class="p">(</span><span class="n">mast_machine</span><span class="p">,</span><span class="n">cam_calib</span><span class="p">,</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;wireframe.png&#39;</span><span class="p">)</span>

<span class="c1"># Show the rendered image using matplotlib</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">rendered_im</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>This results in the following plot:</p>
<img alt="MAST wireframe example" src="_images/mast_wireframe_example.png" />
<p>and also the same image saved to the file <cite>wireframe.png</cite>.</p>
</div>
<div class="section" id="ray-casting">
<h2>Ray casting<a class="headerlink" href="#ray-casting" title="Permalink to this headline">¶</a></h2>
<p>Imagine we have an IR image from a first wall monitoring camera which shows some unusual event at pixel coordinates (100,250). We might want to get the 3D coordinates on the CAD model corresponding to this pixel to tell us where exactly this event took place. We could do this by ray-casting that particular pixel:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">calcam</span>

<span class="c1"># Load the calibration</span>
<span class="n">cam_calib</span> <span class="o">=</span> <span class="n">calcam</span><span class="o">.</span><span class="n">Calibration</span><span class="p">(</span><span class="s1">&#39;my_calibration.ccc&#39;</span><span class="p">)</span>

<span class="c1"># Load the CAD model</span>
<span class="n">jet_machine</span> <span class="o">=</span> <span class="n">calcam</span><span class="o">.</span><span class="n">CADModel</span><span class="p">(</span><span class="s1">&#39;JET&#39;</span><span class="p">)</span>

<span class="c1"># The coordinates at the wall are given by the returned RayData object&#39;s ray_end_coords attribute.</span>
<span class="c1"># Note the 0 index for the first axis because we want the coordinates of the first (and only) point</span>
<span class="c1"># that we ask to be raycast.</span>
<span class="n">coords</span> <span class="o">=</span> <span class="n">calcam</span><span class="o">.</span><span class="n">raycast_sightlines</span><span class="p">(</span><span class="n">cam_calib</span><span class="p">,</span><span class="n">jet_machine</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="mi">250</span><span class="p">)</span><span class="o">.</span><span class="n">ray_end_coords</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]</span>
</pre></div>
</div>
<p>The 3-element array <code class="docutils literal"><span class="pre">coords</span></code> will then contain the <span class="math">\(X,Y,Z\)</span> coordinates, in metres, of where the event of interest appened.</p>
<p>Alternatively, we could ray cast every pixel on the detector and then find the coordinates from whiever one(s) we want afterwards:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">calcam</span>

<span class="c1"># Load the calibration</span>
<span class="n">cam_calib</span> <span class="o">=</span> <span class="n">calcam</span><span class="o">.</span><span class="n">Calibration</span><span class="p">(</span><span class="s1">&#39;my_calibration.ccc&#39;</span><span class="p">)</span>

<span class="c1"># Load the CAD model</span>
<span class="n">jet_machine</span> <span class="o">=</span> <span class="n">calcam</span><span class="o">.</span><span class="n">CADModel</span><span class="p">(</span><span class="s1">&#39;JET&#39;</span><span class="p">)</span>

<span class="c1"># This time get the wall coordinates at every pixel in the image</span>
<span class="n">all_coords</span> <span class="o">=</span> <span class="n">calcam</span><span class="o">.</span><span class="n">raycast_sightlines</span><span class="p">(</span><span class="n">cam_calib</span><span class="p">,</span><span class="n">jet_machine</span><span class="p">)</span><span class="o">.</span><span class="n">ray_end_coords</span>

<span class="c1"># To get the value at pixel x = 100, y = 250, note we have to index the array the other</span>
<span class="c1"># way around because of Python&#39;s 2D array indexing convention.</span>
<span class="n">coords</span> <span class="o">=</span> <span class="n">all_coords</span><span class="p">[</span><span class="mi">250</span><span class="p">,</span><span class="mi">100</span><span class="p">,:]</span>
</pre></div>
</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="dev_imsources.html" class="btn btn-neutral float-right" title="Image Sources" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="api_cadmodel.html" class="btn btn-neutral" title="CAD Models" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015-2018, European Atomic Energy Community (EURATOM).

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  false,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>